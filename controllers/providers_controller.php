<?php/*----------------------------------------------------- Provider insert (1) -------------------------------------------- * Tester si le formulaire d'insertion existe avec le bouton valider de la page gestion fournisseur. * Vérifier si toutes les données envoyées en post existent. * Verifier si variables ne sont pas de caractères blancs (vides). *  Récupère toutes les variables externes et les filtrer.* --------------------------------------------------------------------------------------------------------------------*/if (!empty($_POST) && isset($_POST['btnProviderInsert']) && isset($_POST['society']) && isset($_POST['email'])    && isset($_POST['phone']) && isset($_POST['mobile'])) {    if (ctype_space($_POST['society']) or ctype_space($_POST['email']) or ctype_space($_POST['phone'])        or ctype_space($_POST['mobile'])) {        echo '<i style="color:#850008;font-size:30px;font-family:calibri ;">                Veuillez verifier la saisie de données !</i> ';    } else {        $society = strtoupper(trim(filter_input(INPUT_POST, 'society', FILTER_SANITIZE_STRING)));        $email = filter_input(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);        $phone = filter_input(INPUT_POST, 'phone', FILTER_SANITIZE_NUMBER_INT);        $mobile = filter_input(INPUT_POST, 'mobile', FILTER_SANITIZE_NUMBER_INT);        $credit = trim(filter_input(INPUT_POST, 'credit', FILTER_SANITIZE_NUMBER_FLOAT, FILTER_FLAG_ALLOW_FRACTION));        $creditrest = trim(filter_input(INPUT_POST, 'creditrest', FILTER_SANITIZE_NUMBER_FLOAT, FILTER_FLAG_ALLOW_FRACTION));        $credit = 0;        $creditrest = 0;        // Instancier la class Privers        $provider = new Providers();        $provider->setSociety($society);        $provider->setEmail($email);        $provider->setPhone($phone);        $provider->setMobile($mobile);        $provider->setCredit($credit);        $provider->setCreditrest($creditrest);        // Verification si le fournisseur existe dèja        if ($provider->isProviderExiste($provider->getSociety(), $provider->getEmail())) {            echo '<i style="color:#850008;font-size:30px;font-family:calibri ;">                Fournisseur dèja enregistrée </i> ';        } else {            $provider->addProvider();        }    }/*------------------------------------- End provider insert (1) -------------------------------------------------*/} /*----------------------------------------------- Provider update (2) ------------------------------------------------ * Tester si le formulaire d'update existe avec le bouton valider de la page gestion fournisseur. * Vérifier si toutes les données envoyées en post existent. * Verifier si variables ne sont pas de caractères blancs (vides). *  Récupère toutes les variables externes et les filtrer. *--------------------------------------------------------------------------------------------------------------------*/elseif (!empty($_POST) && isset($_POST['btnProviderUpdate']) && isset($_POST['society']) && isset($_POST['email'])    && isset($_POST['phone']) && isset($_POST['mobile']) && isset($_SESSION['idP'])) {    if (ctype_space($_POST['society']) or ctype_space($_POST['email']) or ctype_space($_POST['phone'])        or ctype_space($_POST['mobile']) or ctype_space($_SESSION['idP'])) {        echo '<i style="color:#850008;font-size:30px;font-family:calibri ;">                Veuillez verifier la saisie de données !</i> ';    } else {        $society = strtoupper(trim(filter_input(INPUT_POST, 'society', FILTER_SANITIZE_STRING)));        $email = filter_input(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);        $phone = filter_input(INPUT_POST, 'phone', FILTER_SANITIZE_NUMBER_INT);        $mobile = filter_input(INPUT_POST, 'mobile', FILTER_SANITIZE_NUMBER_INT);        $idP = trim(filter_var($_SESSION['idP'], FILTER_SANITIZE_NUMBER_INT));        // Instancier la class Privers        $provider = new Providers();        $provider->setSociety($society);        $provider->setEmail($email);        $provider->setPhone($phone);        $provider->setMobile($mobile);        $provider->setIdP($idP);        $provider->updateProvider();        // Destruction de la variable session        unset($_SESSION['idP'], $_SESSION['society_name'], $_SESSION['society_email'], $_SESSION['society_phone']            , $_SESSION['society_mobile']);    }/*-------------------------------------------- End provider update (2) ------------------------------------------*/}/*----------------------------------------------- Provider delete (3) -------------------------------------------------* Tester si le formulaire de suppression existe avec le bouton sppression de la page gestion fournisseurs.* Vérifier si toutes les données envoyées en post existent.* Verifier si variables ne sont pas de caractères blancs (vides).* Récupère toutes les variables externes et les filtrer.*---------------------------------------------------------------------------------------------------------------------*/elseif (!empty($_POST) && isset($_POST['btnProviderDelete']) && isset($_POST['society']) && isset($_POST['email'])    && isset($_POST['phone']) && isset($_POST['mobile']) && isset($_SESSION['idP'])) {    if (ctype_space($_POST['society']) or ctype_space($_POST['email']) or ctype_space($_POST['phone'])        or ctype_space($_SESSION['idP'])) {        echo '<i style="color:#850008;font-size:30px;font-family:calibri ;">                Veuillez verifier la saisie de données !</i> ';    } else {        $idP = trim(filter_var($_SESSION['idP'], FILTER_SANITIZE_NUMBER_INT));        // Verifier si liaison avec commandes        $order = new Orders();        $var = $order->countProviderId($idP);        if ($var > 0) {            echo '<i style="color:#850008;font-size:30px;font-family:calibri ;">                Suppression impossible liaison avec des commandes !</i> ';        } else {            // Suppression de fournisseur            $provider = new Providers();            $provider->setIdP($idP);            $provider->deleteProvider();        }        // Destruction de la variable session        unset($_SESSION['idP'], $_SESSION['society_name'], $_SESSION['society_email'], $_SESSION['society_phone'],            $_SESSION['society_mobile']);    }/*-------------------------------------------- End provider delete (3) ------------------------------------------*/}/*---------------------------------------- Session variable declaration (4) ------------------------------------------- * Tester si la methode GET , l'id , la societe , l'email et le telephone existent de la page gestion fournisseurs. * Tester si les donneés recuperés ne sont pas vides. * Déclarer les donneés en variables de session. *--------------------------------------------------------------------------------------------------------------------*/elseif (!empty($_GET) && isset($_GET['SelectProviderId']) && isset($_GET['society']) && isset($_GET['email'])    && isset($_GET['phone'])) {    if (!empty($_GET['SelectProviderId']) && !empty($_GET['society']) && !empty($_GET['email'])        && !empty($_GET['phone'])) {        $_SESSION['idP'] = filter_input(INPUT_GET, 'SelectProviderId', FILTER_SANITIZE_NUMBER_INT);        $_SESSION['society_name'] = filter_input(INPUT_GET, 'society', FILTER_SANITIZE_STRING);        $_SESSION['society_email'] = trim(filter_input(INPUT_GET, 'email', FILTER_SANITIZE_EMAIL));        $_SESSION['society_phone'] = trim(filter_input(INPUT_GET, 'phone', FILTER_SANITIZE_STRING));        $_SESSION['society_mobile'] = trim(filter_input(INPUT_GET, 'mobile', FILTER_SANITIZE_STRING));    } else {        echo '<i style="color:#85171f;font-size:30px;font-family:calibri ;">Veillez selectionner un fournisseur avant !</i> ';    }/*------------------------------------- End session variable declaration () -------------------------------------*/} /*---------------------------------------- Session variable declaration (5) ------------------------------------------- * Tester si la methode GET , le nom de la  societe existent de la page gestion fournisseurs. * Tester si les donneés recuperés ne sont pas vides. * Déclarer les donneés en variables de session. *--------------------------------------------------------------------------------------------------------------------*/elseif (!empty($_GET) && isset($_GET['SelectNameProvider']) && isset($_GET['providerId'])) {    $_SESSION['provider_name'] = trim(filter_input(INPUT_GET, 'SelectNameProvider', FILTER_SANITIZE_STRING));    $_SESSION['provider_idP'] = trim(filter_input(INPUT_GET, 'providerId', FILTER_SANITIZE_NUMBER_INT));}/*------------------------------------- End session variable declaration (5) -------------------------------------*/